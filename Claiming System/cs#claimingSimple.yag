{{/*
    MADE BY: mangowhite#0001 (209208777365389312)
    REQUESTED BY: 𝑴𝒆𝒍𝒌 𝑻𝒆𝒓𝒕𝒋𝒊𝒆♡☘#0001 (441642976058277898)
    DESCRIPTION: This command is a startup for the claiming reaction system. It"s made to request an embed with reactions which listener will be in another file.
    RECOMMENDED TRIGGER: -claiming
    USAGE METHOD: -claiming <user>
    
    MIT LICENSE
    Copyright (c) 2022 mangowhite
*/}}

{{/*SETTINGS - EDIT AT WILL */}}
{{$workOnThisSoon:= ''}}
{{/*CODE - DO NOT EDIT WITHOUT PROPER KNOWLEDGE*/}}
{{$helpDb:= or (dbGet 0 "help").Value sdict}}
{{$helpDb.Set .Cmd (sdict 
"description" "Generates the claim embed to manage user's claiming state"
"aliases" "no aliases were set"
"category" "cs"
)}}

{{$err:= "❌ You didn't provide any arguments for the execution of this command."}}
{{if and 
    .CmdArgs
    (eq (len .CmdArgs) 1)
}}

    {{$user:= userArg (index .CmdArgs 0)}}

    {{$claimState = nil }}
    {{$instructions:= printf  "This is the panel to the user %s!\n\nThey are currently %s.\nAccess their information using the reactions below:\n1️⃣ Get a DM with the current vows of the user.\n2️⃣Propose Forbidden Claim\n3️⃣Comment about this user." $user.Username (or $claimState "not claimed by anyone.") }}

    {{$embed:= sdict    
    "title" "Claiming Reaction System"
    "description" $instructions
    "color" (randInt 16777215)
    "author" (sdict 
        "name" $user.Username
        "icon_url" ($user.AvatarURL "1024")
    )
    "footer" (sdict
        "text" (printf "Embed reaction command generated by %s" .User.Username)
        "icon_url" (.User.AvatarURL "1024")
    )
    "thumbnail" (sdict "url" "https://i.imgur.com/65OznjD.png")
    }}

    {{$msg:= sendMessageRetID nil (cembed $embed)}}
    {{addMessageReactions nil $msg "1️⃣" "2️⃣" "3️⃣"}}

{{else}}    
    {{sendMessage nil $err}}
{{end}}